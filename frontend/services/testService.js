import axios from "axios";
import AsyncStorage from "@react-native-async-storage/async-storage";

import { API_URL } from '@env';

const testService = {
  /**
   * Get User Tests - ObÈ›ine testele unui utilizator dupÄƒ `userId`.
   */
  getUserTests: async (userId) => {
    try {
      console.log("ğŸ”¹ Fetching tests for user:", userId);
  
      const response = await axios.get(`${API_URL}/api/tests/${userId}`, {
        headers: {
          Authorization: `Bearer ${await AsyncStorage.getItem("token")}`,
        },
      });
  
      console.log("ğŸ“Š Raw Test Data:", response.data);
  
      // ğŸ”¹ VerificÄƒm dacÄƒ datele conÈ›in `$values`
      const testsArray = response.data?.$values || [];
  
      console.log("âœ… Processed Test Data:", testsArray);
      return { success: true, tests: testsArray };
    } catch (error) {
      console.error("âŒ Error fetching user tests:", error.response?.data || error.message);
      return { success: false, message: "Eroare la obÈ›inerea testelor utilizatorului" };
    }
  },
  
};

export default testService;
